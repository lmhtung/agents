{
  "page_content": "### Step 1: Initial Setup and Configuration  \nDefine paths and initialize core components.  \n```python\nimport os\nfrom pathlib import Path\nfrom langchain_huggingface import HuggingFaceEmbeddings\nfrom langchain_qdrant.fastembed_sparse import FastEmbedSparse\nfrom qdrant_client import QdrantClient\n\nDOCS_DIR = \"docs\"  # Directory containing your pdf files\nMARKDOWN_DIR = \"markdown\" # Directory containing the pdfs converted to markdown\nPARENT_STORE_PATH = \"parent_store\"  # Directory for parent chunk JSON files\nCHILD_COLLECTION = \"document_child_chunks\"\n\nos.makedirs(DOCS_DIR, exist_ok=True)\nos.makedirs(MARKDOWN_DIR, exist_ok=True)\nos.makedirs(PARENT_STORE_PATH, exist_ok=True)\n\nfrom langchain_ollama import ChatOllama\nllm = ChatOllama(model=\"qwen3:4b-instruct-2507-q4_K_M\", temperature=0)\n\ndense_embeddings = HuggingFaceEmbeddings(model_name=\"sentence-transformers/all-mpnet-base-v2\")\nsparse_embeddings = FastEmbedSparse(model_name=\"Qdrant/bm25\")\n\nclient = QdrantClient(path=\"qdrant_db\")\n```  \n---\n\n### Step 2: Configure Vector Database  \nSet up Qdrant to store child chunks with hybrid search capabilities.  \n```python\nfrom qdrant_client.http import models as qmodels\nfrom langchain_qdrant import QdrantVectorStore\nfrom langchain_qdrant.qdrant import RetrievalMode\n\nembedding_dimension = len(dense_embeddings.embed_query(\"test\"))\n\ndef ensure_collection(collection_name):\nif not client.collection_exists(collection_name):\nclient.create_collection(\ncollection_name=collection_name,\nvectors_config=qmodels.VectorParams(\nsize=embedding_dimension,\ndistance=qmodels.Distance.COSINE\n),\nsparse_vectors_config={\n\"sparse\": qmodels.SparseVectorParams()\n},\n)\n```  \n---\n\n### Step 3: PDFs to Markdown  \nConvert the PDFs to Markdown. For more details about other techniques use this companion [notebook](pdf_to_md.ipynb).  \n```python\nimport os\nimport pymupdf.layout\nimport pymupdf4llm\nfrom pathlib import Path\nimport glob\n\nos.environ[\"TOKENIZERS_PARALLELISM\"] = \"false\"\n\ndef pdf_to_markdown(pdf_path, output_dir):\ndoc = pymupdf.open(pdf_path)\nmd = pymupdf4llm.to_markdown(doc, header=False, footer=False, page_separators=True, ignore_images=True, write_images=False, image_path=None)\nmd_cleaned = md.encode('utf-8', errors='surrogatepass').decode('utf-8', errors='ignore')\noutput_path = Path(output_dir) / Path(doc.name).stem\nPath(output_path).with_suffix(\".md\").write_bytes(md_cleaned.encode('utf-8'))\n\ndef pdfs_to_markdowns(path_pattern, overwrite: bool = False):\noutput_dir = Path(MARKDOWN_DIR)\noutput_dir.mkdir(parents=True, exist_ok=True)\n\nfor pdf_path in map(Path, glob.glob(path_pattern)):\nmd_path = (output_dir / pdf_path.stem).with_suffix(\".md\")\nif overwrite or not md_path.exists():\npdf_to_markdown(pdf_path, output_dir)\n\npdfs_to_markdowns(f\"{DOCS_DIR}/*.pdf\")\n```  \n---",
  "metadata": {
    "H2": "Implementation -> Implementation -> Implementation",
    "H3": "Step 1: Initial Setup and Configuration -> Step 2: Configure Vector Database -> Step 3: PDFs to Markdown",
    "source": "Instruct.pdf",
    "parent_id": "Instruct_parent_3"
  }
}