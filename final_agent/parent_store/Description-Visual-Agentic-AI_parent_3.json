{
  "page_content": "atheoreticalviewpoint ,pr\n```  \n**4. Xây dựng các hàm in thông tin ra màn hình**  \nĐểxem cách agent hoạt động trong quá trình chạy, chúng ta thiết kếcác hàm sau:  \n- Hàm `pretty_print_message` nhận vào một danh sách tin nhắn ( `message` ) và flag `indent` xác định có thụt đầu dòng khi in hay không. Tin nhắn này sẽđược chuyển sang dạng biểu diễn đẹp hơn ( `pretty_repr` ) hỗtrợhiển thịdưới dạng HTML. Nếu `indent=False` , hàm sẽ in trực tiếp nội dung tin nhắn; ngược lại, mỗi dòng trong nội dung sẽđược thêm ký tựtab đểthụt đầu dòng trước khi hiển thị.  \n- Hàm thứhai, `pretty_print_messages` , được sửdụng đểhiển thịcác tin nhắn trong một cập nhật ( `update` ), có thểđến từmột subgraph hoặc từmột node riêng biệt. Nếu `update` là một tuple, hàm sẽtrích xuất namespace ( `ns` ) và nội dung cập nhật, bỏqua các cập nhật từ graph cha (namespace rỗng) và hiển thịtên subgraph nếu có. Với mỗi nút trong cập nhật, hàm sẽin ra tiêu đềkèm theo tên nút, sau đó chuyển các tin nhắn từdạng nguyên thủy sang đối tượng message bằng hàm `convert_to_messages` . Nếu tham số `last_message=True` , chỉ tin nhắn cuối cùng được hiển thị. Cuối cùng, mỗi tin nhắn được hiển thịbằng cách gọi lại hàm `pretty_print_message` với tùy chọn thụt đầu dòng tương ứng với subgraph hay không.  \n1 `from langchain_core.messages import convert_to_messages`  \n2 3 `def pretty_print_message (message , indent=False):` 4 `pretty_message = message.pretty_repr(html=True)` 5 `if not indent:` 6 `print (pretty_message )` 7 `return` 8 9 `indented = \"\\n\" .join( \"\\t\" + c for c in pretty_message .split( \"\\n\" ))` 10 `print (indented)` 11 12 `def pretty_print_messages (update , last_message=False):` 13 `is_subgraph = False` 14 `if isinstance (update , tuple ):` 15 `ns , update = update` 16 `# skip parent graph updates in the printouts` 17 `if len (ns) == 0:` 18 `return` 19 20 `graph_id = ns[-1]. split( \":\" )[0]` 21 `print (f \"Update from subgraph {graph_id }:\" )` 22 `print ( \"\\n\" )` 23 `is_subgraph = True` 24 25 `for node_name , node_update in update.items ():` 26 `update_label = f \"Update from node {node_name }:\"` 27 `if is_subgraph:` 28 `update_label = \"\\t\" + update_label` 29 30 `print (update_label)` 31 `print ( \"\\n\" )`  \n--- end of page.page_number=7 ---  \n**AI VIETNAM**  \n**aivietnam.edu.vn**  \n32 33 `messages = convert_to_messages (node_update[ \"messages\" ])` 34 `if last_message:` 35 `messages = messages [ -1:]` 36 37 `for m in messages:` 38 `pretty_print_message (m, indent=is_subgraph)` 39 `print ( \"\\n\" )`",
  "metadata": {
    "H2": "**2. Khởi tạo LLM** -> **3. Xây dựng Research Agent**",
    "source": "Description-Visual-Agentic-AI.pdf",
    "parent_id": "Description-Visual-Agentic-AI_parent_3"
  }
}